{"ast":null,"code":"import _slicedToArray from\"/home/ydv/projects/ezichestvo/ts/malenko/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import{useSearchParams}from'react-router-dom';import BlohList from'../components/BlohList';import Fetch from'../components/Fetch';import Pagination from'../components/Pagination';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Bloh=function Bloh(){var _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,2),searchParams=_useSearchParams2[0],setSearchParams=_useSearchParams2[1];var _useState=useState(),_useState2=_slicedToArray(_useState,2),categories=_useState2[0],setCategories=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var page=searchParams.get('page');var currentCategory=searchParams.get('category');useEffect(function(){Fetch(\"/api/v1/bloh-categories\",setCategories);},[]);useEffect(function(){if(currentCategory===null){Fetch(\"/api/v1/blohs?page=\".concat(page),setPosts);}else{Fetch(\"/api/v1/blohs?category=\".concat(currentCategory,\"&page=\").concat(page),setPosts);}},[currentCategory,page]);var selectCategory=function selectCategory(newCategory){setSearchParams({page:'1'});var categoryId=newCategory.id.toString();if(currentCategory!==categoryId){setSearchParams({category:categoryId});currentCategory=categoryId;}else{searchParams.delete('category');}};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"section\",{className:\"last-news--bloh\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bloh__heading-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bloh__heading\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0411\\u043B\\u043E\\u0445\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bloh__categories\",id:\"top\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"categories__heading\",children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"categories__items\",children:categories&&categories.map(function(c){if(c.id.toString()===currentCategory){return/*#__PURE__*/_jsx(\"li\",{onClick:function onClick(){return selectCategory(c);},className:\"active-category\",style:{backgroundColor:c.color},children:c.name},c.id);}return/*#__PURE__*/_jsx(\"li\",{onClick:function onClick(){return selectCategory(c);},style:{backgroundColor:c.color},children:c.name},c.id);})}),!categories&&/*#__PURE__*/_jsx(\"div\",{className:\"bloh__al\",children:/*#__PURE__*/_jsx(\"h5\",{children:\"\\u0413\\u0440\\u0443\\u0437\\u0438\\u043C \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438...\"})})]}),posts&&/*#__PURE__*/_jsx(BlohList,{blohs:posts.blohs}),!posts&&/*#__PURE__*/_jsx(\"div\",{className:\"bloh__alert\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\u041B\\u043E\\u0432\\u0438\\u043C \\u0431\\u043B\\u043E\\u0445\\u043E\\u0432...\"})}),/*#__PURE__*/_jsx(Pagination,{pagination:posts===null||posts===void 0?void 0:posts.pagination,extraClass:\"bloh__pagination--bottom\"})]})});};export default Bloh;","map":{"version":3,"names":["useEffect","useState","useSearchParams","BlohList","Fetch","Pagination","Bloh","searchParams","setSearchParams","categories","setCategories","posts","setPosts","page","get","currentCategory","selectCategory","newCategory","categoryId","id","toString","category","delete","map","c","backgroundColor","color","name","blohs","pagination"],"sources":["/home/ydv/projects/ezichestvo/ts/malenko/frontend/src/pages/Bloh.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport BlohList from '../components/BlohList';\nimport Fetch from '../components/Fetch';\nimport Pagination from '../components/Pagination';\nimport bloh1 from '../images/bloh-1.png';\nimport bloh2 from '../images/bloh-2.png';\nimport { Category, Posts } from '../components/types';\n\nconst Bloh = () => {\n    const [searchParams, setSearchParams] = useSearchParams();\n    const [categories, setCategories] = useState<Category[]>()\n    const [posts, setPosts] = useState<Posts>();\n\n    let page = searchParams.get('page')\n    let currentCategory = searchParams.get('category')\n\n    useEffect(() => {\n        Fetch(\"/api/v1/bloh-categories\", setCategories)\n    }, [])\n\n    useEffect( () => {\n        if (currentCategory === null){\n            Fetch(`/api/v1/blohs?page=${page}`, setPosts)\n        } else {\n            Fetch(`/api/v1/blohs?category=${currentCategory}&page=${page}`, setPosts)\n        }\n    },[currentCategory, page])\n\n    const selectCategory = (newCategory:Category) => {\n        setSearchParams({page: '1'});\n        let categoryId = newCategory.id.toString()\n        if (currentCategory !== categoryId){\n            setSearchParams({category: categoryId});\n            currentCategory = categoryId;\n        } else {\n            searchParams.delete('category')\n        }\n    }\n\n    return(\n\n\t<div className=\"container\">\n\n\t\t<section className=\"last-news--bloh\">\n\t\t\t<div className=\"bloh__heading-wrapper\">\n\t\t\t\t<div className=\"bloh__heading\">\n\n\t\t\t\t\t<h3>Блох</h3>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"bloh__categories\" id=\"top\">\n\t\t\t\t<h4 className=\"categories__heading\">Категории:</h4>\n\t\t\t\t<ul className=\"categories__items\">\n                    {categories && categories.map((c) => {\n                        if (c.id.toString() === currentCategory) {\n                            return(<li key={c.id} onClick={() =>selectCategory(c)} className=\"active-category\" style={{backgroundColor: c.color}}>{c.name}</li>)\n                        }\n                        return(\n                            <li key={c.id} onClick={() =>selectCategory(c)} style={{backgroundColor: c.color}}>{c.name}</li>\n                        )\n                    })}\n\t\t\t\t</ul>\n        {!categories && (\n            <div className=\"bloh__al\"><h5>Грузим категории...</h5></div>\n        )}\n\t\t\t</div>\n\n            {posts && <BlohList blohs={posts.blohs}/>}\n            {!posts && (\n                <div className=\"bloh__alert\"><h3>Ловим блохов...</h3></div>\n            )}\n\n            <Pagination pagination={posts?.pagination} extraClass='bloh__pagination--bottom'/>\n        </section>\n        </div>\n    )\n}\n\nexport default Bloh;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}