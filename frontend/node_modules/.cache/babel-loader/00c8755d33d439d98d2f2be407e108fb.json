{"ast":null,"code":"var _jsxFileName = \"/home/ydv/projects/ezichestvo/ts/malenko/frontend/src/pages/Bloh.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport BlohList from '../components/BlohList';\nimport Fetch from '../components/Fetch';\nimport Pagination from '../components/Pagination';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Bloh = () => {\n  _s();\n\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [categories, setCategories] = useState();\n  const [posts, setPosts] = useState();\n  let page = searchParams.get('page');\n  let currentCategory = searchParams.get('category');\n  useEffect(() => {\n    Fetch(\"/api/v1/bloh-categories\", setCategories);\n  }, []);\n  useEffect(() => {\n    if (currentCategory === null) {\n      Fetch(`/api/v1/blohs?page=${page}`, setPosts);\n    } else {\n      Fetch(`/api/v1/blohs?category=${currentCategory}&page=${page}`, setPosts);\n    }\n  }, [currentCategory, page]);\n\n  const selectCategory = newCategory => {\n    setSearchParams({\n      page: '1'\n    });\n    let categoryId = newCategory.id.toString();\n\n    if (currentCategory !== categoryId) {\n      setSearchParams({\n        category: categoryId\n      });\n      currentCategory = categoryId;\n    } else {\n      searchParams.delete('category');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"last-news--bloh\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bloh__heading-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bloh__heading\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\u0411\\u043B\\u043E\\u0445\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 6\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 5\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 4\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bloh__categories\",\n        id: \"top\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"categories__heading\",\n          children: \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"categories__items\",\n          children: categories && categories.map(c => {\n            if (c.id.toString() === currentCategory) {\n              return /*#__PURE__*/_jsxDEV(\"li\", {\n                onClick: () => selectCategory(c),\n                className: \"active-category\",\n                style: {\n                  backgroundColor: c.color\n                },\n                children: c.name\n              }, c.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 58,\n                columnNumber: 36\n              }, this);\n            }\n\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              onClick: () => selectCategory(c),\n              style: {\n                backgroundColor: c.color\n              },\n              children: c.name\n            }, c.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 61,\n              columnNumber: 29\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 5\n        }, this), !categories && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bloh__al\",\n          children: /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"\\u0413\\u0440\\u0443\\u0437\\u0438\\u043C \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 39\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 4\n      }, this), posts && /*#__PURE__*/_jsxDEV(BlohList, {\n        blohs: posts.blohs\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 23\n      }, this), !posts && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bloh__alert\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u041B\\u043E\\u0432\\u0438\\u043C \\u0431\\u043B\\u043E\\u0445\\u043E\\u0432...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 46\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n        pagination: posts === null || posts === void 0 ? void 0 : posts.pagination,\n        extraClass: \"bloh__pagination--bottom\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 3\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 2\n  }, this);\n};\n\n_s(Bloh, \"6mdo9wZFtSMBqnFOjRZP3BlVNg8=\", false, function () {\n  return [useSearchParams];\n});\n\n_c = Bloh;\nexport default Bloh;\n\nvar _c;\n\n$RefreshReg$(_c, \"Bloh\");","map":{"version":3,"names":["useEffect","useState","useSearchParams","BlohList","Fetch","Pagination","Bloh","searchParams","setSearchParams","categories","setCategories","posts","setPosts","page","get","currentCategory","selectCategory","newCategory","categoryId","id","toString","category","delete","map","c","backgroundColor","color","name","blohs","pagination"],"sources":["/home/ydv/projects/ezichestvo/ts/malenko/frontend/src/pages/Bloh.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport BlohList from '../components/BlohList';\nimport Fetch from '../components/Fetch';\nimport Pagination from '../components/Pagination';\nimport bloh1 from '../images/bloh-1.png';\nimport bloh2 from '../images/bloh-2.png';\nimport { Category, Posts } from '../components/types';\n\nconst Bloh = () => {\n    const [searchParams, setSearchParams] = useSearchParams();\n    const [categories, setCategories] = useState<Category[]>()\n    const [posts, setPosts] = useState<Posts>();\n\n    let page = searchParams.get('page')\n    let currentCategory = searchParams.get('category')\n\n    useEffect(() => {\n        Fetch(\"/api/v1/bloh-categories\", setCategories)\n    }, [])\n\n    useEffect( () => {\n        if (currentCategory === null){\n            Fetch(`/api/v1/blohs?page=${page}`, setPosts)\n        } else {\n            Fetch(`/api/v1/blohs?category=${currentCategory}&page=${page}`, setPosts)\n        }\n    },[currentCategory, page])\n\n    const selectCategory = (newCategory:Category) => {\n        setSearchParams({page: '1'});\n        let categoryId = newCategory.id.toString()\n        if (currentCategory !== categoryId){\n            setSearchParams({category: categoryId});\n            currentCategory = categoryId;\n        } else {\n            searchParams.delete('category')\n        }\n    }\n\n    return(\n\n\t<div className=\"container\">\n\n\t\t<section className=\"last-news--bloh\">\n\t\t\t<div className=\"bloh__heading-wrapper\">\n\t\t\t\t<div className=\"bloh__heading\">\n\n\t\t\t\t\t<h3>Блох</h3>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div className=\"bloh__categories\" id=\"top\">\n\t\t\t\t<h4 className=\"categories__heading\">Категории:</h4>\n\t\t\t\t<ul className=\"categories__items\">\n                    {categories && categories.map((c) => {\n                        if (c.id.toString() === currentCategory) {\n                            return(<li key={c.id} onClick={() =>selectCategory(c)} className=\"active-category\" style={{backgroundColor: c.color}}>{c.name}</li>)\n                        }\n                        return(\n                            <li key={c.id} onClick={() =>selectCategory(c)} style={{backgroundColor: c.color}}>{c.name}</li>\n                        )\n                    })}\n\t\t\t\t</ul>\n        {!categories && (\n            <div className=\"bloh__al\"><h5>Грузим категории...</h5></div>\n        )}\n\t\t\t</div>\n\n            {posts && <BlohList blohs={posts.blohs}/>}\n            {!posts && (\n                <div className=\"bloh__alert\"><h3>Ловим блохов...</h3></div>\n            )}\n\n            <Pagination pagination={posts?.pagination} extraClass='bloh__pagination--bottom'/>\n        </section>\n        </div>\n    )\n}\n\nexport default Bloh;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}